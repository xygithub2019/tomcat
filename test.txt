1、登录ManageOne-DB

******数据库密码解析
cat /opt/share/manager/DBAgent/zenith_ResourcePool.json| grep -A 10 -i mosmdb| grep "dbuser_password"

su ossadm
source /opt/oss/manager/bin/engr_profile.sh
python
from util import ossext
ossext.Cipher.decrypt0()
*******************************

su dbuser
/opt/zenith/app/bin/zsql mosmdb/Huawei@123@127.0.0.1:32081

执行sql
delete from TBL_THRESHOLD_CONDITION WHERE THRESHOLD_ALARM_ID IN(select ID from TBL_THRESHOLD_ALARM where MONITOR_UNIT_ID in(select MONITOR_UNIT_ID from TBL_RES_TYPE_MONITOR_UNIT_REL where RES_TYPE_ID in(select RES_TYPE_ID from TBL_RES_TYPE where INDEX_NAME IN( '云服务名称'))));

delete from TBL_THRESHOLD_CONDITION where RES_INST_ID in(select RES_INST_ID from TBL_RES_INST_MONITOR_UNIT_REL where MONITOR_UNIT_ID IN(select MONITOR_UNIT_ID from TBL_RES_TYPE_MONITOR_UNIT_REL where RES_TYPE_ID in(select RES_TYPE_ID from TBL_RES_TYPE where INDEX_NAME IN( '云服务名称'))));


delete from TBL_THRESHOLD_ALARM where MONITOR_UNIT_ID in(select MONITOR_UNIT_ID from TBL_RES_TYPE_MONITOR_UNIT_REL where RES_TYPE_ID in(select RES_TYPE_ID from TBL_RES_TYPE where INDEX_NAME IN( '云服务名称')));
commit;


2、登录ManageOne-Service01
curl -i -k -H "Content-Type: application/json" -X POST -u admin:ACI\$awD7k\@D4 -d '{"query":{"term":{"dataSet":"perf-mosm-云服务小写"}}}' https://localhost:9200/.threshold-sys/_delete_by_query

参数perf-mosm-云服务小写



https://support.huawei.com/enterprise/zh/category/cloud-computing-pid-1482614363727?submodel=software
